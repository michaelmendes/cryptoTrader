package cryptoTrader.utils;

public class Operation {
		
	private String name;
	private CryptocoinList coins;
	private String tradingStrategy;
	private TradingBroker broker;
		
	public Operation(TradingBroker tradeBroker) {
		name = tradeBroker.getName();	
		coins = tradeBroker.getCoinList();
		tradingStrategy = tradeBroker.getStrategy();
		broker = tradeBroker;
	}
	
	public String getTradingBroker() {
		return name;
	}
	
	public CryptocoinList getCoins() {
		return coins;
	}
	
	public String tradingStrategy() {
		return tradingStrategy;
	}
	
	public TradeActivity executeTrade() {
		TradingStrategy obj = new TradingStrategy(tradingStrategy, coins);
		String data = obj.performTrade(); // returns a string of the format: action quantity coinName price
		String[] dataList = data.split(" ");
		if(dataList[0].equals("failed")) {
			// failed string has the message "failed transaction"
			TradeActivity activity = new TradeActivity(broker, tradingStrategy);
			return activity;
		}
		else {
			CryptoCoin coin = new CryptoCoin(dataList[2]);
			coin.setCoinPrice(Double.parseDouble(dataList[3]));
			System.out.println(coin.getCoinPrice());
			TradeActivity activity = new TradeActivity(broker, dataList[0], dataList[1], coin);
			return activity;
		}
	}
	
}
